### 二、Agent copy.py代码目的和功能描述

#### 1. **目的描述**

1.**分布式任务调度** ：

* 通过AWS SQS实现分布式任务的接收和执行，适用于需要远程控制或自动化任务的场景。

2.**自动化任务处理** ：

* 可以用于自动化处理队列中的任务，例如日志收集、数据处理等。

3.**学习和演示** ：

* 作为学习AWS SQS和Boto3库的示例，帮助开发者理解如何使用Python与AWS SQS进行交互，包括接收、发送消息和执行命令。

#### 2. **功能描述**

1.**生成唯一代理ID并注册** ：

* 在首次运行时，检查是否存在锁文件 `agent.lock`。如果不存在，生成一个唯一的代理ID，并将代理信息（包括代理ID和主机名）存储到锁文件中。
* 将代理信息发送到注册队列 `registration_url`，完成代理的注册。

 2.**获取代理ID** ：

* 从锁文件中读取代理ID，用于后续的消息处理。

3.**接收消息** ：

* 从指定的接收队列 `receivequeue_url`中接收消息，每次最多接收1条消息。

4.**处理消息** ：

* 解析接收到的消息内容（JSON格式），提取消息中的代理ID和命令内容。
* 如果消息中的代理ID与当前代理ID匹配，则执行命令。

5.**执行命令** ：

* 使用 `subprocess`模块执行命令，并捕获命令的输出或错误信息。

6.**发送结果** ：

* 将命令的执行结果发送到指定的发送队列 `sendqueue_url`。

7.**删除已处理消息** ：

* 在命令执行并发送结果后，从接收队列中删除已处理的消息。

8.**循环运行** ：

* 脚本运行在一个无限循环中，每隔5秒检查一次接收队列，持续处理新消息。

9.**优雅退出** ：

* 支持通过Ctrl + C优雅退出程序。
